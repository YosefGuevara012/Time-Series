---
output: html_notebook
---


3.Haga una simulación de un VARMA(2,1)

Se carga la libreria
```{r}
library(MTS)
```

Se establecen los parametros del modelo VARMA(2,1), que tiene la forma:

$$z_t = \phi_1 z_{t-1} + \phi_2 z_{t-2} + a_t - \theta_1 a_{t-1}$$
```{r}

p1=matrix(c(.816,-1.116,-.623,1.074),2,2)
p2=matrix(c(-.643,.615,.592,-.133),2,2)
phi=cbind(p1,p2)
t1=matrix(c(0,-.801,-1.248,0),2,2)
Sig=matrix(c(4,2,2,5),2,2)
   
```

Cuyos parametros son:

$$\phi_1 =\begin{bmatrix}
0.816 & -0.623\\ 
-1.116 & 1.074
\end{bmatrix},\phi_2 =\begin{bmatrix}
-0.643 & 0.592\\ 
0.615 & -0.133
\end{bmatrix},\theta_1 =\begin{bmatrix}
0 & -1.248\\ 
-0.801 & 0
\end{bmatrix}, {\sum}_a =\begin{bmatrix}
4 & 2\\ 
2 & 5
\end{bmatrix}$$

a)	 Genere 500 muestras del modelo VARMA(2,1). 

Se establece una semilla para que sea posible replicar los resultados de la simulación, esta simulación se lleva a cabo con 500 muestras.

```{r}
set.seed(123)
m1=VARMAsim(500,arlags=c(1,2),malags=c(1),phi=phi,
                theta=t1,sigma=Sig)
```

A continuación se extraen los valores de las series calculadas por la simulación.

```{r}
zt = m1$series
```

Luego de esto se visualizan las series simuladas.
```{r}
par(mfrow=c(2,1))
plot(zt[,1],type="l",xlab="index",ylab="S1")
plot(zt[,2],type="l",xlab="index",ylab="S2")
```


b)	Ajuste el modelo VARMA(2,1))

Para ajustar el modelo VARMA utilizamos el siguiente comando. Donde XXXXXXX

```{r}
m2 = VARMA(zt,p=2,q=1)
```

Al ajustar nuestro modelo tenemos que esta dado por:

$$z_t=\begin{bmatrix}
-0.025\\-0.022 
\end{bmatrix}+\begin{bmatrix}
0.798  & -0.582 \\ 
-1.222 & 1.099
\end{bmatrix}z_{t-1}+\begin{bmatrix}
-0.622 & 0.550 \\ 
 0.687 & -0.158
\end{bmatrix}z_{t-2} + a_t - \begin{bmatrix}
-0.040 & -1.151\\ 
-0.826 & 0.009
\end{bmatrix}a_{t-1},\hat{\sum}_a = \begin{bmatrix}
3.915 & 1.952\\ 
1.952 & 5.269 \\ 
\end{bmatrix}$$

c)	Escriba los modelos ajustados

Al refinar el modelo VARMA  poniendo a cero estimaciones insignificantes

```{r}
m2a = refVARMA(m2,thres=0.8)
```
$$z_t=\begin{bmatrix}
0.818  & -0.634 \\ 
-1.183 & 1.085
\end{bmatrix}z_{t-1}+\begin{bmatrix}
-0.668 & 0.592 \\ 
 0.647 & -0.150
\end{bmatrix}z_{t-2} + a_t - \begin{bmatrix}
0.00 & -1.21\\ 
-0.774 & 0.00
\end{bmatrix}a_{t-1},\hat{\sum}_a = \begin{bmatrix}
3.946 & 1.967\\ 
1.967 & 5.276\\ 
\end{bmatrix}$$

```{r}
m2b = refVARMA(m2a,thres=1)
```
$$z_t=\begin{bmatrix}
0\\
0 
\end{bmatrix}+\begin{bmatrix}
0.818  & -0.634 \\ 
-1.183 & 1.085
\end{bmatrix}z_{t-1}+\begin{bmatrix}
-0.668 & 0.592 \\ 
 0.647 & -0.150
\end{bmatrix}z_{t-2} + a_t - \begin{bmatrix}
0.00 & -1.21\\ 
-0.774 & 0.00
\end{bmatrix}a_{t-1},\hat{\sum}_a = \begin{bmatrix}
3.946 & 1.967\\ 
1.967 & 5.276\\ 
\end{bmatrix}$$
```{r}
m2c = refVARMA(m2b,thres=1)
```
$$z_t=\begin{bmatrix}
0\\
0 
\end{bmatrix}+\begin{bmatrix}
0.818  & -0.634 \\ 
-1.183 & 1.085
\end{bmatrix}z_{t-1}+\begin{bmatrix}
-0.668 & 0.592 \\ 
 0.647 & -0.150
\end{bmatrix}z_{t-2} + a_t - \begin{bmatrix}
0.00 & -1.21\\ 
-0.774 & 0.00
\end{bmatrix}a_{t-1},\hat{\sum}_a = \begin{bmatrix}
3.946 & 1.967\\ 
1.967 & 5.276\\ 
\end{bmatrix}$$

d)	Interprete la FACE de los residuos.

```{r}
zt=m1$series
m2=Eccm(zt,maxp=5,maxq=6)
```



